import"./app-BbCczviw.js";import"./share-zDZSOXv8.js";import{h as C}from"./header-hbux8tjE.js";import{_ as n,s as L}from"./utils-CiWJl2H0.js";import{a as q,c as F,b as M}from"./createCourseCard-muIbRLDY.js";import{g as _,b as k}from"./coursesAPIs-_Czvxgn5.js";import{g as B}from"./categoriesAPIs-8lepWyj_.js";import"./usersAPIs-Q3VVH7n2.js";window.courseClickHandler=q;window.categoryClickHandler=F;const r=document;C(r);let i="all",d=!1,m=!1,u="all",c=null;const v=r.querySelector(".overlay"),H=r.querySelector(".mobile-filters__open-btn"),I=r.querySelector(".mobile-sort__open-btn"),T=r.querySelector(".mobile-sort__open-btn--text"),P=r.querySelector(".mobile-filters-menu__close"),A=r.querySelector(".mobile-sort-menu__close"),S=r.querySelector(".mobile-filters-menu"),g=r.querySelector(".mobile-sort-menu"),p=r.querySelectorAll(".sort__value"),f=r.querySelectorAll(".mobile-sort__value"),x=()=>{n("add",S,["open"]),n("add",document.documentElement,["overflow-hidden"])},w=()=>{n("remove",S,["open"]),n("remove",document.documentElement,["overflow-hidden"])};H.addEventListener("click",x);P.addEventListener("click",w);const N=()=>{n("add",g,["open"]),n("add",document.documentElement,["overflow-hidden"]),n("add",v,["show"])},b=()=>{n("remove",g,["open"]),n("remove",document.documentElement,["overflow-hidden"]),n("remove",v,["show"])};I.addEventListener("click",N);A.addEventListener("click",b);const E=r.querySelector(".category-title"),h=r.querySelector(".course__container");f.forEach(e=>{e.addEventListener("click",()=>{f.forEach(o=>{n("remove",o,["active"])}),n("add",e,["active"]),b()})});v.addEventListener("click",()=>{b()});const O=async()=>{const e=new Proxy(new URLSearchParams(window.location.search),{get:(o,l)=>o.get(l)});i=(await B())?.find(o=>o.categoryId==e.category)||"all",c=e.s?e.s:null,$(),await a()},$=()=>{E.innerHTML=c?`جستجو : ${c}`:i==="all"?"همه دوره ها":i.categoryName?i.categoryName:"ارور"};p.forEach(e=>{e.addEventListener("click",async o=>{p.forEach(l=>{n("remove",l,["active"])}),n("add",e,["active"]),u=e.dataset.sort,await a()})});f.forEach(e=>{e.addEventListener("click",async o=>{p.forEach(l=>{n("remove",l,["active"])}),n("add",e,["active"]),T.innerHTML=e.children[0].innerHTML,u=e.dataset.sort,await a()})});const V=()=>{r.querySelector("#only-free-input").addEventListener("change",async()=>{d=!d,await a()})},j=()=>{r.querySelector("#only-presell-input").addEventListener("change",async()=>{m=!m,await a()})},D=()=>{const e=r.querySelector("#mobile-only-free-input"),o=r.querySelector("#mobile-only-presell-input"),l=r.querySelector(".mobile-filters-menu-submit"),y=r.querySelector(".mobile-filters-menu-clear");let t=!1,s=!1;e.addEventListener("change",()=>{t=!t}),o.addEventListener("change",()=>{s=!s}),l.addEventListener("click",async()=>{d=t,m=s,await a(),w()}),y.addEventListener("click",()=>{e.checked=!1,o.checked=!1,t=!1,s=!1})},R=()=>{const e=r.querySelector("#search-course-form"),o=r.querySelector("#search-course");e.addEventListener("submit",async l=>{l.preventDefault(),c=o.value,E.innerHTML=`جستجو:  ${c}`,await a()})},a=async()=>{let e=i==="all"?await _():(await k(i.categoryId))?.courses;if(!e){L("دوره ای برای این دسته بندی وجود ندارد");return}let o=d&&m?e.filter(t=>t.isFree&&t.status=="presell"):d?e.filter(t=>t.isFree):m?e.filter(t=>t.status=="presell"):[...e],l=u=="cheapest"?[...o].sort((t,s)=>t.price-s.price).filter(t=>!t.isFree):u=="expensive"?[...o].sort((t,s)=>s.price-t.price).filter(t=>!t.isFree):u=="popular"?[...o].sort((t,s)=>s.studentsCount-t.studentsCount):[...o],y=c?l.filter(t=>t.title.includes(c)||t.shortName.includes(c)):[...l];h.innerHTML="",y.forEach(t=>{h.insertAdjacentHTML("beforeend",M(t))})};window.addEventListener("load",async()=>{await O(),V(),j(),D(),R()});
